version: v1.0
agent:
  machine:
    type: e1-standard-4
    os_image: ubuntu2004
# fail_fast:
#   cancel:
#     when: branch != 'main'
auto_cancel:
  queued:
    when: branch != 'main'
  running:
    when: branch != 'main'
blocks:
  - name: Install dependencies
    task:
      secrets:
          - name: playground-client-build
      prologue:
        commands:
          - checkout
          - nvm install && nvm use
          - dev

promotions:
  - name: Deploy - playground (playground.abyssfabric.co)
    pipeline_file: playground-deploy.yml
